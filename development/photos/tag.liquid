---
pagination:
  alias: tag
  data: photos.tags
  size: 1
permalink: "photos/{{ tag.title | slugify }}/"
---

{% comment %}
The album and tag paginated generations do not use the main layout template file.
They have their own layout to facilitate OpenGraph meta tags.
That is why <head> is split into its own include here.
{% endcomment %}

<!DOCTYPE html>
<html lang="en">

	{%- assign folder = tag.album | slugify %}
	{%- assign thumbnail = "https://cdn.m0b1.dev/vrc/" | concat: folder | concat: '/' | concat: tag.thumbnail -%}
	{% render "head", title: page.url, ogTitle: tag.title, thumbnail: thumbnail %}

	<body>
		<main>

			<h1>
				<a href="/photos/tags" title="Return">&lArr;</a>
				{{ tag.title }}
			</h1>

			{%- assign tagSlug = tag.title | slugify -%}
			{%- assign displayedImages = 0 -%}

			{%- for album in photos.albums -%}

				{%- assign applicablePhotos = '' | split: '' -%}
				{%- for photo in album.photos -%}
					{%- assign tags = photo[1] | split: ', ' -%}
					{%- if tags contains tagSlug -%}
						{%- assign applicablePhotos = applicablePhotos | push: photo -%}
					{%- endif -%}
				{%- endfor -%}

				{% if applicablePhotos.size > 0 %}

					<hr>

					<div id="{{ album.title | slugify }}">

						<h2>
							{{ album.title }}
						</h2>

						{% for photo in applicablePhotos %}

							{%- assign altText = album.title | concat: ': ' | concat: photo[0] -%}

							{% render "image",
								index: displayedImages,
								folder: album.title,
								file: photo[0],
								altText: altText
							%}

							{%- assign displayedImages = displayedImages | plus: 1 -%}

						{% endfor %}
					</div>

				{% endif %}

			{%- endfor -%}
		</main>
	</body>
</html>

